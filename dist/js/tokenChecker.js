var jwt=require("jsonwebtoken"),config=require("./config"),QueryBuilder=require("node-querybuilder"),settings=require("./db");module.exports=function(a,d,e){var b=a.body.token||a.query.token||a.headers["x-access-token"];if(b)jwt.verify(b,config.secret,function(c,b){if(c)return d.status(401).json({error:!0,message:"Unauthorized access."});a.decoded=b;c=new QueryBuilder(settings,"mysql","single");a.qb=c;e()});else return d.status(403).send({error:!0,message:"No token provided."})};